<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒãƒƒã‚°ãƒã‚§ãƒƒã‚¯ - ãƒãƒã‚«ãƒ‰ï¼</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .check-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ccc;
        }
        .check-item.success {
            border-left-color: #4CAF50;
        }
        .check-item.error {
            border-left-color: #f44336;
        }
        .status {
            font-weight: bold;
            margin-left: 10px;
        }
        .success .status {
            color: #4CAF50;
        }
        .error .status {
            color: #f44336;
        }
        button {
            background: #D4622A;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #B84E1F;
        }
        #results {
            margin-top: 20px;
        }
        pre {
            background: #333;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” ãƒãƒã‚«ãƒ‰ï¼ãƒ‡ãƒãƒƒã‚°ãƒã‚§ãƒƒã‚¯</h1>
    <p>ã“ã®ãƒšãƒ¼ã‚¸ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã§ãã¾ã™ã€‚</p>

    <div id="results">
        <div class="check-item" id="check-common">
            ğŸ“„ common.js ã®èª­ã¿è¾¼ã¿: <span class="status">ãƒã‚§ãƒƒã‚¯ä¸­...</span>
        </div>
        <div class="check-item" id="check-auth">
            ğŸ” auth.js ã®èª­ã¿è¾¼ã¿: <span class="status">ãƒã‚§ãƒƒã‚¯ä¸­...</span>
        </div>
        <div class="check-item" id="check-cart">
            ğŸ›’ cart ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ: <span class="status">ãƒã‚§ãƒƒã‚¯ä¸­...</span>
        </div>
        <div class="check-item" id="check-auth-obj">
            ğŸ‘¤ auth ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ: <span class="status">ãƒã‚§ãƒƒã‚¯ä¸­...</span>
        </div>
        <div class="check-item" id="check-localstorage">
            ğŸ’¾ LocalStorage: <span class="status">ãƒã‚§ãƒƒã‚¯ä¸­...</span>
        </div>
    </div>

    <h2>ğŸ§ª ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½</h2>
    <button onclick="testLogin()">ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    <button onclick="testCart()">ã‚«ãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ</button>
    <button onclick="clearStorage()">LocalStorageã‚¯ãƒªã‚¢</button>

    <h2>ğŸ“Š ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿</h2>
    <pre id="dataDisplay"></pre>

    <h2>ğŸ› ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼</h2>
    <pre id="errorDisplay">ã‚¨ãƒ©ãƒ¼ãªã—</pre>

    <script src="js/common.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒ
        window.addEventListener('error', function(e) {
            const errorDisplay = document.getElementById('errorDisplay');
            errorDisplay.textContent = `ã‚¨ãƒ©ãƒ¼: ${e.message}\nãƒ•ã‚¡ã‚¤ãƒ«: ${e.filename}\nè¡Œ: ${e.lineno}`;
            errorDisplay.style.color = '#f44336';
        });

        // ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
        setTimeout(() => {
            // common.js ãƒã‚§ãƒƒã‚¯
            const checkCommon = document.getElementById('check-common');
            if (typeof showToast === 'function') {
                checkCommon.classList.add('success');
                checkCommon.querySelector('.status').textContent = 'âœ… æˆåŠŸ';
            } else {
                checkCommon.classList.add('error');
                checkCommon.querySelector('.status').textContent = 'âŒ å¤±æ•—';
            }

            // auth.js ãƒã‚§ãƒƒã‚¯
            const checkAuth = document.getElementById('check-auth');
            if (typeof Auth === 'function') {
                checkAuth.classList.add('success');
                checkAuth.querySelector('.status').textContent = 'âœ… æˆåŠŸ';
            } else {
                checkAuth.classList.add('error');
                checkAuth.querySelector('.status').textContent = 'âŒ å¤±æ•—';
            }

            // cart ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯
            const checkCart = document.getElementById('check-cart');
            if (typeof cart !== 'undefined') {
                checkCart.classList.add('success');
                checkCart.querySelector('.status').textContent = 'âœ… å­˜åœ¨ã™ã‚‹';
            } else {
                checkCart.classList.add('error');
                checkCart.querySelector('.status').textContent = 'âŒ å­˜åœ¨ã—ãªã„';
            }

            // auth ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯
            const checkAuthObj = document.getElementById('check-auth-obj');
            if (typeof auth !== 'undefined') {
                checkAuthObj.classList.add('success');
                checkAuthObj.querySelector('.status').textContent = 'âœ… å­˜åœ¨ã™ã‚‹';
            } else {
                checkAuthObj.classList.add('error');
                checkAuthObj.querySelector('.status').textContent = 'âŒ å­˜åœ¨ã—ãªã„';
            }

            // LocalStorage ãƒã‚§ãƒƒã‚¯
            const checkLS = document.getElementById('check-localstorage');
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                checkLS.classList.add('success');
                checkLS.querySelector('.status').textContent = 'âœ… åˆ©ç”¨å¯èƒ½';
            } catch (e) {
                checkLS.classList.add('error');
                checkLS.querySelector('.status').textContent = 'âŒ åˆ©ç”¨ä¸å¯';
            }

            // ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
            updateDataDisplay();
        }, 500);

        function updateDataDisplay() {
            const dataDisplay = document.getElementById('dataDisplay');
            const data = {
                'ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹': typeof auth !== 'undefined' ? auth.isLoggedIn() : 'authæœªå®šç¾©',
                'ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±': localStorage.getItem('machikado_user'),
                'ã‚«ãƒ¼ãƒˆæƒ…å ±': localStorage.getItem('machikado_cart'),
                'ã‚«ãƒ¼ãƒˆå•†å“æ•°': typeof cart !== 'undefined' ? cart.getItemCount() : 'cartæœªå®šç¾©'
            };
            dataDisplay.textContent = JSON.stringify(data, null, 2);
        }

        function testLogin() {
            if (typeof auth === 'undefined') {
                alert('âŒ auth ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ã¾ã›ã‚“ï¼\nauth.js ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
                return;
            }

            const result = auth.login('buyer@example.com', 'password');
            if (result.success) {
                alert('âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼\n' + JSON.stringify(result.user, null, 2));
                updateDataDisplay();
            } else {
                alert('âŒ ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—:\n' + result.error);
            }
        }

        function testCart() {
            if (typeof cart === 'undefined') {
                alert('âŒ cart ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ã¾ã›ã‚“ï¼\ncommon.js ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚');
                return;
            }

            cart.addItem(1);
            alert('âœ… ã‚«ãƒ¼ãƒˆã«å•†å“ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼\nç¾åœ¨ã®å•†å“æ•°: ' + cart.getItemCount());
            updateDataDisplay();
        }

        function clearStorage() {
            localStorage.clear();
            alert('âœ… LocalStorageã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            updateDataDisplay();
            setTimeout(() => location.reload(), 500);
        }

        // è‡ªå‹•æ›´æ–°
        setInterval(updateDataDisplay, 2000);
    </script>

    <hr style="margin: 40px 0;">
    <h2>ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
    
    <h3>âŒ ã‚‚ã— auth.js ã‚„ common.js ãŒã€Œå¤±æ•—ã€ã®å ´åˆï¼š</h3>
    <ol>
        <li><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª:</strong>
            <ul>
                <li>GitHub ãƒªãƒã‚¸ãƒˆãƒªã§ <code>js/auth.js</code> ã¨ <code>js/common.js</code> ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª</li>
            </ul>
        </li>
        <li><strong>ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèª:</strong>
            <ul>
                <li>F12 â†’ Console ã‚¿ãƒ–</li>
                <li>404ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ãªã„ã‹ç¢ºèª</li>
            </ul>
        </li>
        <li><strong>GitHub Pagesã®ãƒ“ãƒ«ãƒ‰çŠ¶æ³ç¢ºèª:</strong>
            <ul>
                <li>GitHub ãƒªãƒã‚¸ãƒˆãƒª â†’ Actions ã‚¿ãƒ–</li>
                <li>æœ€æ–°ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒæˆåŠŸã—ã¦ã„ã‚‹ã‹ç¢ºèª</li>
            </ul>
        </li>
        <li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢:</strong>
            <ul>
                <li>Ctrl + Shift + R (Windows)</li>
                <li>Cmd + Shift + R (Mac)</li>
            </ul>
        </li>
    </ol>

    <h3>âœ… ã‚‚ã—å…¨ã¦ã€ŒæˆåŠŸã€ãªã®ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„å ´åˆï¼š</h3>
    <ol>
        <li>ä¸Šã®ã€Œãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‹•ä½œç¢ºèª</li>
        <li>æˆåŠŸã—ãŸã‚‰ã€login.html ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§</li>
    </ol>

    <hr>
    <p><a href="index.html">â† ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a> | <a href="login.html">ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ â†’</a></p>
</body>
</html>
